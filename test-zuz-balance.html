<!DOCTYPE html>
<html>
<head>
    <title>ZUZ Balance Test</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Arial; background: #0f172a; color: white; padding: 20px; }
        .balance { font-size: 48px; color: #2d6df6; margin: 20px 0; }
        .address { font-family: monospace; background: #1e293b; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>üîç ZUZ Balance Test</h1>
    
    <div>
        <button id="connectBtn">–ü–æ–¥–∫–ª—é—á–∏—Ç—å MetaMask</button>
        <button id="checkBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å</button>
    </div>
    
    <div class="balance" id="balanceDisplay">0 ZUZ</div>
    
    <div class="address">
        <strong>–¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:</strong><br>
        <span id="contractAddress">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
    </div>
    
    <div id="debugInfo" style="margin-top: 20px; color: #94a3b8;"></div>
    
    <script>
        // –ù–û–í–´–ô –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
        const ZUZ_TOKEN_ADDRESS = "0x4284ecC7E6E560cAfc0bA65CbDFc9c19bd2C0bD3";
        
        document.getElementById('contractAddress').textContent = ZUZ_TOKEN_ADDRESS;
        
        async function checkRealBalance() {
            try {
                const response = await fetch('/api/token-info');
                const tokenInfo = await response.json();
                
                document.getElementById('debugInfo').innerHTML = `
                    <strong>API Response:</strong><br>
                    Name: ${tokenInfo.name}<br>
                    Symbol: ${tokenInfo.symbol}<br>
                    Address: ${tokenInfo.address}<br>
                    Total Supply: ${(parseInt(tokenInfo.totalSupply) / 1e18).toLocaleString()} ${tokenInfo.symbol}
                `;
                
                if (typeof window.ethereum !== 'undefined' && window.ethereum.selectedAddress) {
                    const address = window.ethereum.selectedAddress;
                    const balanceResponse = await fetch(`/api/balance/${address}`);
                    const balanceData = await balanceResponse.json();
                    
                    document.getElementById('balanceDisplay').textContent = 
                        `${parseFloat(balanceData.formatted).toLocaleString()} ZUZ`;
                }
            } catch (error) {
                document.getElementById('debugInfo').textContent = '–û—à–∏–±–∫–∞: ' + error.message;
            }
        }
        
        document.getElementById('connectBtn').addEventListener('click', async () => {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    alert('–ü–æ–¥–∫–ª—é—á–µ–Ω–æ: ' + accounts[0]);
                    checkRealBalance();
                } catch (error) {
                    alert('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message);
                }
            } else {
                alert('MetaMask –Ω–µ –Ω–∞–π–¥–µ–Ω!');
            }
        });
        
        document.getElementById('checkBtn').addEventListener('click', checkRealBalance);
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        checkRealBalance();
    </script>
</body>
</html>
