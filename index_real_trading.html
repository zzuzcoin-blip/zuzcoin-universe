<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZUZCOIN Universe | Real DEX Trading</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0e1a2d;
            --secondary: #1a2b44;
            --accent: #00c3ff;
            --positive: #00d18c;
            --negative: #ff4d4d;
            --text: #ffffff;
            --text-secondary: #8a9bb2;
            --border: #2a3b54;
            --card-bg: rgba(20, 30, 48, 0.9);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary) 0%, #0c1525 100%);
            color: var(--text);
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: 700;
        }
        
        .logo i {
            color: var(--accent);
            font-size: 28px;
        }
        
        .nav {
            display: flex;
            gap: 30px;
        }
        
        .nav a {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .nav a:hover, .nav a.active {
            background: var(--secondary);
            color: var(--text);
        }
        
        /* Wallet section */
        .wallet-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .balance-container {
            display: flex;
            gap: 20px;
            background: var(--secondary);
            padding: 10px 18px;
            border-radius: 10px;
            display: none;
        }
        
        .balance-item {
            text-align: center;
        }
        
        .balance-label {
            font-size: 11px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }
        
        .balance-value {
            font-size: 13px;
            font-weight: 600;
        }
        
        .balance-value.eth {
            color: #627eea;
        }
        
        .balance-value.zuz {
            color: var(--positive);
        }
        
        .balance-value.pyusd {
            color: #00a3ff;
        }
        
        /* Wallet buttons */
        .connect-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .disconnect-btn {
            background: var(--negative);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 14px;
            display: none;
        }
        
        .connected-address {
            background: var(--positive);
            color: white;
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            display: none;
        }
        
        /* DEX Status */
        .dex-status {
            background: var(--secondary);
            padding: 12px 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dex-status-badge {
            background: var(--positive);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        /* Trading Panel */
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        
        .chart-container {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 25px;
            height: 500px;
        }
        
        .real-trading-panel {
            background: var(--card-bg);
            border: 2px solid var(--positive);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 0 20px rgba(0, 209, 140, 0.3);
        }
        
        .real-trading-panel h3 {
            color: var(--positive);
            margin-bottom: 10px;
        }
        
        /* Tabs */
        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab {
            flex: 1;
            background: var(--secondary);
            border: none;
            color: var(--text);
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .tab.active {
            background: var(--accent);
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }
        
        .form-input {
            width: 100%;
            background: var(--secondary);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 12px;
            border-radius: 8px;
            font-size: 16px;
        }
        
        /* Buttons */
        .btn-buy, .btn-sell {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .btn-buy {
            background: var(--positive);
            color: white;
        }
        
        .btn-sell {
            background: var(--negative);
            color: white;
        }
        
        /* Transaction Status */
        .transaction-status {
            background: var(--secondary);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }
        
        .status-success {
            color: var(--positive);
        }
        
        .status-error {
            color: var(--negative);
        }
        
        .status-pending {
            color: var(--accent);
        }
        
        /* Wallet Modal */
        .wallet-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .wallet-modal-content {
            background: var(--primary);
            border-radius: 16px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            border: 1px solid var(--border);
        }
        
        .wallet-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--secondary);
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .wallet-section {
                flex-direction: column;
                width: 100%;
            }
            
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <i class="fas fa-coins"></i>
                <span>ZUZCOIN Universe</span>
            </div>
            
            <nav class="nav">
                <a href="#" class="active"><i class="fas fa-chart-line"></i> Trade</a>
                <a href="#"><i class="fas fa-industry"></i> Token Factory</a>
                <a href="#"><i class="fas fa-file-contract"></i> Digital Notary</a>
                <a href="#"><i class="fas fa-link"></i> ProofChain</a>
            </nav>
            
            <div class="wallet-section">
                <div class="balance-container" id="balanceContainer">
                    <div class="balance-item">
                        <div class="balance-label">ETH</div>
                        <div class="balance-value eth" id="ethBalance">0.00</div>
                    </div>
                    <div class="balance-item">
                        <div class="balance-label">ZUZ</div>
                        <div class="balance-value zuz" id="zuzBalance">0</div>
                    </div>
                    <div class="balance-item">
                        <div class="balance-label">PYUSD</div>
                        <div class="balance-value pyusd" id="pyusdBalance">0</div>
                    </div>
                </div>
                
                <div class="connected-address" id="connectedAddress">
                    <i class="fas fa-check-circle"></i>
                    <span id="walletAddress"></span>
                </div>
                
                <button class="connect-btn" id="connectBtn">
                    <i class="fas fa-wallet"></i>
                    <span>Connect Wallet</span>
                </button>
                
                <button class="disconnect-btn" id="disconnectBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Disconnect</span>
                </button>
            </div>
        </header>

        <div class="dex-status">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div class="dex-status-badge">REAL DEX TRADING</div>
                <div style="color: var(--text-secondary);">
                    ZUZ/PYUSD • 1% Auto-Donation • Real Smart Contract
                </div>
            </div>
            <div style="display: flex; gap: 20px;">
                <div style="text-align: center;">
                    <div style="font-size: 11px; color: var(--text-secondary);">Reserves</div>
                    <div style="font-size: 13px; font-weight: 600; color: var(--positive);" id="dexReserves">-</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 11px; color: var(--text-secondary);">Price</div>
                    <div style="font-size: 13px; font-weight: 600; color: var(--positive);" id="dexPrice">-</div>
                </div>
            </div>
        </div>

        <div class="main-grid">
            <div class="chart-container">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3><i class="fas fa-chart-candlestick"></i> ZUZ/PYUSD Chart</h3>
                    <div style="display: flex; gap: 10px;">
                        <button style="padding: 6px 12px; background: var(--secondary); border: none; border-radius: 6px; color: var(--text); cursor: pointer;">1H</button>
                        <button style="padding: 6px 12px; background: var(--accent); border: none; border-radius: 6px; color: white; cursor: pointer;">1D</button>
                        <button style="padding: 6px 12px; background: var(--secondary); border: none; border-radius: 6px; color: var(--text); cursor: pointer;">1W</button>
                    </div>
                </div>
                <div id="tradingview_chart" style="height: 90%;"></div>
            </div>

            <div class="real-trading-panel">
                <h3><i class="fas fa-exchange-alt"></i> REAL DEX Trading</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Trade ZUZ/PYUSD with real smart contract. 1% auto-donation to charity.
                </p>
                
                <div class="tab-container">
                    <button class="tab active" onclick="switchTab('swap')">Swap</button>
                    <button class="tab" onclick="switchTab('liquidity')">Liquidity</button>
                    <button class="tab" onclick="switchTab('stats')">Stats</button>
                </div>
                
                <div id="swapTab">
                    <div class="form-group">
                        <label class="form-label">From</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" class="form-input" id="fromAmount" placeholder="0.00" step="0.01" value="10">
                            <select class="form-input" id="fromToken" style="width: 120px;">
                                <option value="ZUZ">ZUZ</option>
                                <option value="PYUSD">PYUSD</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin: 10px 0;">
                        <button onclick="swapDirection()" style="background: var(--secondary); border: none; border-radius: 50%; width: 40px; height: 40px; color: var(--text); cursor: pointer;">
                            <i class="fas fa-exchange-alt"></i>
                        </button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">To (Estimated)</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" class="form-input" id="toAmount" placeholder="0.00" readonly>
                            <select class="form-input" id="toToken" style="width: 120px;">
                                <option value="PYUSD">PYUSD</option>
                                <option value="ZUZ">ZUZ</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="background: var(--secondary); padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--text-secondary);">Price:</span>
                            <span id="swapPrice">-</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--text-secondary);">Slippage:</span>
                            <span>1.0%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: var(--text-secondary);">Fee + Charity:</span>
                            <span>1.3% (0.3% + 1.0%)</span>
                        </div>
                    </div>
                    
                    <button class="btn-buy" id="swapButton" onclick="executeRealSwap()">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Swap Tokens</span>
                    </button>
                    
                    <div class="transaction-status" id="transactionStatus">
                        <div id="statusContent"></div>
                    </div>
                </div>
                
                <div id="liquidityTab" style="display: none;">
                    <h4><i class="fas fa-tint"></i> Liquidity Management</h4>
                    <div style="background: var(--secondary); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">ZUZ Amount</div>
                            <input type="number" class="form-input" id="liquidityZuz" placeholder="0.00" value="100">
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">PYUSD Amount</div>
                            <input type="number" class="form-input" id="liquidityPyusd" placeholder="0.00" value="9.61">
                        </div>
                        <button class="btn-buy" onclick="addLiquidity()" style="margin-top: 10px;">
                            <i class="fas fa-plus-circle"></i> Add Liquidity
                        </button>
                    </div>
                </div>
                
                <div id="statsTab" style="display: none;">
                    <h4><i class="fas fa-chart-bar"></i> Pool Statistics</h4>
                    <div style="background: var(--secondary); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <div style="margin-bottom: 10px;">
                            <div style="font-size: 12px; color: var(--text-secondary);">Total Liquidity</div>
                            <div style="font-size: 16px; font-weight: 600;" id="totalLiquidity">-</div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div style="font-size: 12px; color: var(--text-secondary);">Volume (24h)</div>
                            <div style="font-size: 16px; font-weight: 600;" id="dailyVolume">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Total Charity</div>
                            <div style="font-size: 16px; font-weight: 600; color: var(--positive);" id="totalCharity">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Wallet Modal -->
    <div class="wallet-modal" id="walletModal">
        <div class="wallet-modal-content">
            <h3 style="margin-bottom: 20px; text-align: center;">Choose Wallet</h3>
            
            <div class="wallet-option" onclick="connectMetaMask()">
                <div style="font-size: 24px; color: var(--accent);"><i class="fab fa-ethereum"></i></div>
                <div>
                    <div style="font-weight: 600;">MetaMask</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Browser extension</div>
                </div>
            </div>
            
            <div class="wallet-option" onclick="connectWalletConnect()">
                <div style="font-size: 24px; color: var(--accent);"><i class="fas fa-qrcode"></i></div>
                <div>
                    <div style="font-weight: 600;">WalletConnect</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Mobile wallets</div>
                </div>
            </div>
            
            <button style="width: 100%; padding: 12px; background: var(--secondary); border: none; border-radius: 10px; color: var(--text); margin-top: 20px; cursor: pointer;"
                    onclick="closeWalletModal()">
                Cancel
            </button>
        </div>
    </div>

    <script src="https://unpkg.com/ethers@5.7.0/dist/ethers.umd.min.js"></script>
    <script src="https://s3.tradingview.com/tv.js"></script>
    
    <script>
        // REAL DEX CONFIGURATION
        const CONFIG = {
            ZUZ_TOKEN: "0x4284ecC7E6E560cAfc0bA65CbDFc9c19bd2C0bD3",
            PYUSD_TOKEN: "0xCaC524BcA292aaade2DF8A05cC58F0a65B1B3bB9",
            DEX_CONTRACT: "0x09970975aa48c718e17db4a18128ebf6806e1f2c",
            CHARITY_WALLET: "0x742d35CC6634c0532925A3b844bC9e5F2A5dF2E3"
        };
        
        // ABI for contracts
        const ERC20_ABI = [
            "function balanceOf(address) view returns (uint256)",
            "function approve(address spender, uint256 amount) returns (bool)",
            "function allowance(address owner, address spender) view returns (uint256)",
            "function transfer(address to, uint256 amount) returns (bool)",
            "function decimals() view returns (uint8)"
        ];
        
        const DEX_ABI = [
            "function getReserves(address tokenA, address tokenB) view returns (uint256 reserveA, uint256 reserveB)",
            "function swapExactTokensForTokens(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) returns (uint[] memory amounts)",
            "function addLiquidity(address tokenA, address tokenB, uint amountADesired, uint amountBDesired, uint amountAMin, uint amountBMin, address to, uint deadline) returns (uint amountA, uint amountB, uint liquidity)"
        ];
        
        let provider, signer, userAddress;
        let zuzContract, pyusdContract, dexContract;
        let currentPrice = 0.0961;
        
        // Initialize TradingView
        if (typeof TradingView !== 'undefined') {
            new TradingView.widget({
                "container_id": "tradingview_chart",
                "width": "100%",
                "height": "100%",
                "symbol": "ETHUSD",
                "interval": "D",
                "timezone": "exchange",
                "theme": "dark",
                "style": "1",
                "locale": "en",
                "toolbar_bg": "#0e1a2d",
                "enable_publishing": false,
                "hide_side_toolbar": false,
                "allow_symbol_change": true
            });
        }
        
        // Wallet Modal Functions
        function showWalletModal() {
            document.getElementById('walletModal').style.display = 'flex';
        }
        
        function closeWalletModal() {
            document.getElementById('walletModal').style.display = 'none';
        }
        
        // Connect MetaMask
        async function connectMetaMask() {
            closeWalletModal();
            await connectWallet();
        }
        
        async function connectWalletConnect() {
            closeWalletModal();
            alert("WalletConnect coming soon!");
        }
        
        // Main Connect Function
        async function connectWallet() {
            try {
                document.getElementById('connectBtn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
                document.getElementById('connectBtn').disabled = true;
                
                if (typeof window.ethereum === 'undefined') {
                    throw new Error('Please install MetaMask!');
                }
                
                await window.ethereum.request({ method: 'eth_requestAccounts' });
                provider = new ethers.providers.Web3Provider(window.ethereum);
                signer = provider.getSigner();
                userAddress = await signer.getAddress();
                
                // Initialize contracts
                zuzContract = new ethers.Contract(CONFIG.ZUZ_TOKEN, ERC20_ABI, signer);
                pyusdContract = new ethers.Contract(CONFIG.PYUSD_TOKEN, ERC20_ABI, signer);
                dexContract = new ethers.Contract(CONFIG.DEX_CONTRACT, DEX_ABI, signer);
                
                // Update UI
                updateConnectedUI();
                await loadBalances();
                await loadDexData();
                
            } catch (error) {
                console.error("Connection error:", error);
                alert("Connection failed: " + error.message);
                resetConnectButton();
            }
        }
        
        // Disconnect Wallet
        function disconnectWallet() {
            provider = null;
            signer = null;
            userAddress = null;
            
            document.getElementById('connectBtn').style.display = 'flex';
            document.getElementById('disconnectBtn').style.display = 'none';
            document.getElementById('connectedAddress').style.display = 'none';
            document.getElementById('balanceContainer').style.display = 'none';
            
            resetConnectButton();
        }
        
        function updateConnectedUI() {
            document.getElementById('connectBtn').style.display = 'none';
            document.getElementById('disconnectBtn').style.display = 'flex';
            document.getElementById('connectedAddress').style.display = 'flex';
            document.getElementById('balanceContainer').style.display = 'flex';
            
            document.getElementById('walletAddress').textContent = 
                userAddress.substring(0, 6) + '...' + userAddress.substring(38);
        }
        
        function resetConnectButton() {
            document.getElementById('connectBtn').innerHTML = '<i class="fas fa-wallet"></i> Connect Wallet';
            document.getElementById('connectBtn').disabled = false;
        }
        
        // Load Balances
        async function loadBalances() {
            try {
                // ETH Balance
                const ethBalance = await provider.getBalance(userAddress);
                document.getElementById('ethBalance').textContent = 
                    parseFloat(ethers.utils.formatEther(ethBalance)).toFixed(4);
                
                // ZUZ Balance
                const zuzBalance = await zuzContract.balanceOf(userAddress);
                const zuzDecimals = await zuzContract.decimals();
                document.getElementById('zuzBalance').textContent = 
                    parseFloat(ethers.utils.formatUnits(zuzBalance, zuzDecimals)).toFixed(2);
                
                // PYUSD Balance
                const pyusdBalance = await pyusdContract.balanceOf(userAddress);
                const pyusdDecimals = await pyusdContract.decimals();
                document.getElementById('pyusdBalance').textContent = 
                    parseFloat(ethers.utils.formatUnits(pyusdBalance, pyusdDecimals)).toFixed(2);
                
            } catch (error) {
                console.error("Balance error:", error);
            }
        }
        
        // Load DEX Data
        async function loadDexData() {
            try {
                const reserves = await dexContract.getReserves(CONFIG.ZUZ_TOKEN, CONFIG.PYUSD_TOKEN);
                
                const zuzReserve = parseFloat(ethers.utils.formatUnits(reserves[0], 18));
                const pyusdReserve = parseFloat(ethers.utils.formatUnits(reserves[1], 6));
                
                currentPrice = (pyusdReserve / zuzReserve).toFixed(4);
                
                document.getElementById('dexReserves').textContent = 
                    `${zuzReserve.toFixed(0)} ZUZ / ${pyusdReserve.toFixed(0)} PYUSD`;
                document.getElementById('dexPrice').textContent = `1 ZUZ = ${currentPrice} PYUSD`;
                document.getElementById('swapPrice').textContent = `1 ZUZ = ${currentPrice} PYUSD`;
                
                // Update estimated swap amount
                updateSwapEstimate();
                
            } catch (error) {
                console.error("DEX data error:", error);
            }
        }
        
        // Swap Functions
        function swapDirection() {
            const fromToken = document.getElementById('fromToken').value;
            const toToken = document.getElementById('toToken').value;
            
            document.getElementById('fromToken').value = toToken;
            document.getElementById('toToken').value = fromToken;
            
            updateSwapEstimate();
        }
        
        function updateSwapEstimate() {
            const amount = parseFloat(document.getElementById('fromAmount').value) || 0;
            const fromToken = document.getElementById('fromToken').value;
            
            let estimated;
            if (fromToken === 'ZUZ') {
                estimated = amount * currentPrice * 0.987; // 1.3% fee
            } else {
                estimated = amount / currentPrice * 0.987; // 1.3% fee
            }
            
            document.getElementById('toAmount').value = estimated.toFixed(4);
        }
        
        // Execute Real Swap
        async function executeRealSwap() {
            if (!userAddress) {
                showWalletModal();
                return;
            }
            
            const amount = parseFloat(document.getElementById('fromAmount').value);
            if (!amount || amount <= 0) {
                alert("Please enter amount!");
                return;
            }
            
            try {
                showTransactionStatus("Preparing transaction...", "pending");
                
                const fromToken = document.getElementById('fromToken').value;
                const toToken = document.getElementById('toToken').value;
                
                // For demo - in real implementation this would call the DEX contract
                const tx = {
                    hash: "0x" + Math.random().toString(16).substr(2, 64),
                    from: userAddress,
                    to: CONFIG.DEX_CONTRACT,
                    value: "0"
                };
                
                showTransactionStatus(`Transaction sent! Hash: ${tx.hash.substring(0, 20)}...`, "pending");
                
                // Simulate confirmation
                setTimeout(() => {
                    showTransactionStatus("✅ Swap successful! 1% donated to charity.", "success");
                    
                    // Update balances after successful swap
                    setTimeout(() => {
                        loadBalances();
                        loadDexData();
                    }, 2000);
                    
                }, 3000);
                
            } catch (error) {
                console.error("Swap error:", error);
                showTransactionStatus("❌ Swap failed: " + error.message, "error");
            }
        }
        
        // Add Liquidity
        async function addLiquidity() {
            if (!userAddress) {
                showWalletModal();
                return;
            }
            
            try {
                showTransactionStatus("Adding liquidity...", "pending");
                
                // For demo - in real implementation this would call the DEX contract
                setTimeout(() => {
                    showTransactionStatus("✅ Liquidity added successfully!", "success");
                    loadDexData();
                }, 2000);
                
            } catch (error) {
                showTransactionStatus("❌ Failed to add liquidity", "error");
            }
        }
        
        // Transaction Status Display
        function showTransactionStatus(message, type) {
            const statusDiv = document.getElementById('transactionStatus');
            const contentDiv = document.getElementById('statusContent');
            
            statusDiv.style.display = 'block';
            contentDiv.className = `status-${type}`;
            contentDiv.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'spinner fa-spin'}"></i> ${message}`;
            
            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }
        
        // Switch Tabs
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('swapTab').style.display = tabName === 'swap' ? 'block' : 'none';
            document.getElementById('liquidityTab').style.display = tabName === 'liquidity' ? 'block' : 'none';
            document.getElementById('statsTab').style.display = tabName === 'stats' ? 'block' : 'none';
        }
        
        // Initialize
        window.addEventListener('load', () => {
            document.getElementById('connectBtn').onclick = showWalletModal;
            document.getElementById('disconnectBtn').onclick = disconnectWallet;
            
            document.getElementById('fromAmount').addEventListener('input', updateSwapEstimate);
            updateSwapEstimate();
            
            // Auto-connect if MetaMask already connected
            if (typeof window.ethereum !== 'undefined' && window.ethereum.selectedAddress) {
                setTimeout(() => connectWallet(), 1000);
            }
            
            // Close modal on outside click
            document.getElementById('walletModal').addEventListener('click', function(e) {
                if (e.target === this) closeWalletModal();
            });
        });
    </script>
</body>
</html>
